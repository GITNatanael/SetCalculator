const containerResults = document.querySelector('.Container-results');
const btnHorizontal = document.querySelector('.Horizontal');
const btnVertical = document.querySelector('.Vertical');
const cardResults = document.querySelectorAll('.Card-result');



btnHorizontal.addEventListener('click', function() {
  const promesasTarjetas = [];
  cardResults.forEach((cardResult) => {
    promesasTarjetas.push(new Promise((resolve) => {
      cardResult.style.opacity = "0";
      cardResult.addEventListener("transitionend", resolve, { once: true });
    }));
  });

  Promise.all(promesasTarjetas).then(() => {
    cardResults.forEach((cardResult) => {
      cardResult.style.opacity = "1";
      cardResult.style.width = "100rem";
      cardResult.style.height = "100rem";

      //.Content-card-result Anulador
      const contentCardResult = cardResult.querySelector('.Content-card-result');
      contentCardResult.style.maxHeight= "70rem";
      contentCardResult.style.height = "auto";
      contentCardResult.style.overflow = "auto";


      //.Column Anulador
      const columnClasses = containerResults.querySelectorAll('.Column');
      columnClasses.forEach((columnClass) => {
        columnClass.style.display = "grid";
        columnClass.style.alignContent = "center";
        columnClass.style.gridTemplateColumns = "repeat(3, 1fr)";
        columnClass.style.gap = "5rem";
      });
    });

    containerResults.style.gridTemplateColumns = 'repeat(6, 1fr)';
    containerResults.style.gridAutoFlow = "row";
    containerResults.style.gridColumnGap = '5rem';
    containerResults.style.width = '100%';
    containerResults.style.height = 'max-content';
    containerResults.style.gridRowGap = '0rem';
    containerResults.style.marginLeft = '0';
  });

  // Elimina el evento 'click' de las cardResults
  cardResults.forEach((cardResult) => {
    cardResult.removeEventListener('click', null);
  });
});

btnVertical.addEventListener('click', function() {
  const promesasTarjetas = [];
  cardResults.forEach((cardResult) => {
    promesasTarjetas.push(new Promise((resolve) => {
      cardResult.style.opacity = "0";
      cardResult.addEventListener("transitionend", resolve, { once: true });
    }));
  });

  Promise.all(promesasTarjetas).then(() => {
    let activeCardResult = null;
    let activeContentCardResult = null;

    cardResults.forEach((cardResult) => {
      cardResult.style.opacity = "1";
      cardResult.style.width = "50rem";
      cardResult.style.height = "max-content";

      //.Content-card-result modificador
      const contentCardResult = cardResult.querySelector('.Content-card-result');
      contentCardResult.style.height = "5rem";
      contentCardResult.style.overflow = "hidden";

     
      //Evento clic, cambia tamaño
      cardResult.addEventListener('click', function() {
        if (activeContentCardResult && activeContentCardResult !== contentCardResult) {
          activeContentCardResult.style.height = "5rem";
        }
        if (contentCardResult.style.height === "5rem") {
          contentCardResult.style.height = "100%";
          contentCardResult.style.maxHeight = "70rem";
          contentCardResult.style.overflow = "auto";
          contentCardResult.style.overflowX = 'hidden';
          activeContentCardResult = contentCardResult;
          activeCardResult = cardResult;
        } else {
          contentCardResult.style.height = "5rem";
          contentCardResult.style.overflow = "hidden";
          activeContentCardResult = null;
          activeCardResult = null;
        }
      });

      //.Column modificador
      const columnClasses = containerResults.querySelectorAll('.Column');
      columnClasses.forEach((columnClass) => {
        columnClass.style.display = "grid";
        columnClass.style.alignContent = "center";
        columnClass.style.gridTemplateColumns = "1fr";
        columnClass.style.gap = "1rem";
        columnClass.style.alignItems= 'center';
      });
    });

    containerResults.style.gridTemplateColumns = ' repeat(2, max-content) repeat(4, max-content)';
    containerResults.style.gridAutoFlow = "row dense";
    containerResults.style.gridColumnGap = '1.5rem';
    containerResults.style.gridRowGap = '1rem';
    containerResults.style.width = '110rem';
    containerResults.style.height = '150rem';
    containerResults.style.overflow = 'auto';
    containerResults.style.marginLeft = '10vw';
    containerResults.style.alignItems= 'center';
  });
});



//JQuery Al hacer clic en una .Card-result, esta aumenta de tamaño o se deselecciona
$(document).ready(function() {
  $('.Card-result').click(function() {
    if ($(this).hasClass('active')) {
      $(this).removeClass('active');
      $(this).find('.Content-card-result').removeClass('active2'); //Incluye el .Content-card-result
    } else {
      $('.Card-result').removeClass('active');
      $('.Content-card-result').removeClass('active2');
      $(this).addClass('active');
      $(this).find('.Content-card-result').addClass('active2');
    }
  });
});
